(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{32:function(e,t,n){e.exports=n.p+"static/media/chef.feb48811.png"},50:function(e,t,n){e.exports=n(78)},55:function(e,t,n){},57:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(45),c=n.n(s),o=(n(55),n(9)),u=n.n(o),i=n(11),l=n(4),p=n(5),m=n(7),h=n(6),f=n(8),d=(n(57),n(18)),v=n.n(d),b=function e(){var t=this;Object(l.a)(this,e),this.login=function(){var e=Object(i.a)(u.a.mark((function e(n){var r,a,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.username,a=n.password,e.next=3,t.service.post("/auth/login",{username:r,password:a});case 3:return s=e.sent,c=s.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.signup=function(){var e=Object(i.a)(u.a.mark((function e(n){var r,a,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.username,a=n.password,e.next=3,t.service.post("/auth/signup",{username:r,password:a});case 3:return s=e.sent,c=s.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.isLoggedIn=Object(i.a)(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("/auth/isLoggedIn");case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),this.logout=Object(i.a)(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("/auth/logout");case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),this.service=v.a.create({baseURL:"https://your-local-food-guide.herokuapp.com/",withCredentials:!0})},g=n(22),O=n(1),j=n(49);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}r.Component;var E=function e(){var t=this;Object(l.a)(this,e),this.addBusiness=function(){var e=Object(i.a)(u.a.mark((function e(n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.post("/places",{id:n});case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.service=v.a.create({baseURL:"https://your-local-food-guide.herokuapp.com/",withCredentials:!0})},S=function e(){var t=this;Object(l.a)(this,e),this.removeBusiness=function(){var e=Object(i.a)(u.a.mark((function e(n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.delete("/places/".concat(n));case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.service=v.a.create({baseURL:"https://your-local-food-guide.herokuapp.com/",withCredentials:!0})},k=function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).addPlace=function(){n.addService.addBusiness(n.props.id).then((function(e){n.setState({showBtn:!1})})).catch((function(e){console.error(e)}))},n.removePlace=function(){n.removeService.removeBusiness(n.props.id).then((function(e){n.setState({showBtn:!0}),n.props.removePlace(n.props.id)})).catch((function(e){console.error(e)}))};var r=!0;return e.user&&(r=!e.user.places.includes(n.props.id)),n.state={places:[],showBtn:r},n.addService=new E,n.removeService=new S,n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return this.props.id?a.a.createElement("div",{className:"business-layout"},a.a.createElement("h2",null,this.props.name),a.a.createElement("h4",null,this.props.categories&&this.props.categories[0].title," |"," ",this.props.price," | ",this.props.rating),a.a.createElement("img",{className:"business-image",src:this.props.image_url,alt:""}),!this.props.user&&a.a.createElement("div",null,a.a.createElement("button",{className:"submit",type:"submit",onClick:function(){return e.addPlace()}},"Sign Up or Login | Add to your Food Guide")),this.props.user&&a.a.createElement("div",null,this.state.showBtn&&a.a.createElement("button",{className:"submit",type:"submit",onClick:function(){return e.addPlace()}},"Add to my food guide"),!this.state.showBtn&&a.a.createElement("button",{className:"submit",type:"submit",onClick:function(){return e.removePlace()}},"Remove from my food guide"))):null}}]),t}(r.Component);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=v.a.create({baseURL:"https://api.yelp.com/v3/",headers:{Authorization:"Bearer ".concat("ETpD-WScgVpK-jsn29ZUxpHEVTM8mzHn3u2zISzVCzvuaBxK-Z5Qkfb7EjRllLLdXH0AJnbtpwQ0gqisdPTMrJtNf7vSKqr9jQxuGWzwmNlnjT6P15LpwKhVsFTiXXYx")}}),P=v.a.create({baseURL:"http://localhost:3002/"}),L=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return P.get("restaurantsPerCity",{params:{location:e}})},U={getRestaurants:function(e){return N.get("/businesses/search",{params:C({limit:10,categories:"restaurants"},e),crossDomain:!0}).then((function(e){e.data.businesses.map((function(e){return{name:e.name,coords:e.coordinates}}))})).catch((function(e){console.error(e)}))}},D=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).removePlace=function(e){var t=n.state.places.filter((function(t){return t.id!==e}));n.setState({places:t})},n.state={places:[],user:null},n.service=new b,n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(u.a.mark((function e(){var t,n,r=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.service.isLoggedIn();case 2:t=e.sent,n=t.places.map(function(){var e=Object(i.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a=t,P.get("businesses/"+a);case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}var a}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),Promise.all(n).then((function(e){console.log(e.filter((function(e){return e}))),r.setState({places:e.filter((function(e){return e})),user:t})})).catch((function(e){console.log(e)}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("h1",null,"Welcome ",this.props.user.username),this.state.places.map((function(t,n){return a.a.createElement(k,Object.assign({key:n},t,{user:e.state.user,removePlace:e.removePlace}))})))}}]),t}(r.Component),I=n(21),H=function(e){var t=e.component,n=e.user,r=Object(I.a)(e,["component","user"]);return a.a.createElement(g.b,Object.assign({},r,{render:function(e){return n?a.a.createElement(t,Object.assign({},e,{user:n},r)):a.a.createElement(g.a,{to:"/"})}}))};function B(e){var t=e.className;return a.a.createElement("div",{className:t},a.a.createElement("div",{className:"spinner"}))}var R=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(m.a)(this,Object(h.a)(t).call(this))).onChangeHandler=function(t){var n=t.target,r=n.name,a=n.value;e.setState(Object(O.a)({},r,a))},e.submitHandler=function(){var t=Object(i.a)(u.a.mark((function t(n){var r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,e.authService.login(e.state);case 4:r=t.sent,e.props.setUserState(r),e.props.history.push("/profile"),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(1),a=t.t0.message,t.t0.response&&(a=t.t0.response.data.message),e.setState({err:a});case 14:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),e.state={username:"",password:"",err:null},e.authService=new b,e}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"login"},a.a.createElement("p",null,"Hungry to find more of your favorite food? Login now!"),a.a.createElement("form",{onSubmit:this.submitHandler},a.a.createElement("input",{onChange:this.onChangeHandler,type:"text",name:"username",placeholder:"Your username"}),a.a.createElement("input",{onChange:this.onChangeHandler,type:"password",name:"password",placeholder:"Your password"}),a.a.createElement("button",{className:"submit",type:"submit"},"Login!")),this.state.err&&a.a.createElement("p",{className:"error"},this.state.err))}}]),t}(r.Component),A=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(m.a)(this,Object(h.a)(t).call(this))).onChangeHandler=function(t){var n=t.target,r=n.name,a=n.value;e.setState(Object(O.a)({},r,a))},e.submitHandler=function(){var t=Object(i.a)(u.a.mark((function t(n){var r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,e.authService.signup(e.state);case 4:r=t.sent,e.props.setUserState(r),e.props.history.push("/profile"),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(1),a=t.t0.message,t.t0.response&&(a=t.t0.response.data.message),e.setState({err:a});case 14:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),e.state={username:"",password:"",err:null},e.authService=new b,e}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"signup"},a.a.createElement("p",null,"Want to join our global local food guide community? Sign up now!"),a.a.createElement("form",{onSubmit:this.submitHandler},a.a.createElement("input",{onChange:this.onChangeHandler,type:"text",name:"username",placeholder:"Your username"}),a.a.createElement("input",{onChange:this.onChangeHandler,type:"password",name:"password",placeholder:"Your password"}),a.a.createElement("input",{onChange:this.onChangeHandler,type:"email",name:"email",placeholder:"Email address"}),a.a.createElement("button",{className:"submit",type:"submit"},"Sign Up")),this.state.err&&a.a.createElement("p",{className:"error"},this.state.err))}}]),t}(r.Component),F=n(32),G=n.n(F),T=n(14),W=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.props.user?a.a.createElement("nav",null,a.a.createElement("img",{className:"navItem",src:G.a,width:"2%",alt:""}),a.a.createElement(T.b,{className:"navItem",to:"/"},"Home"),a.a.createElement(T.b,{className:"navItem",to:"/foodies"},"Find Foodies"),a.a.createElement(T.b,{className:"navItem",to:"/profile"},this.props.user.username),a.a.createElement(T.b,{className:"navItem",onClick:this.props.logout,to:"/"},"Logout")):a.a.createElement("nav",null,a.a.createElement("img",{className:"navItem",src:G.a,width:"2%",alt:""}),a.a.createElement(T.b,{className:"navItem",to:"/"},"Home"),a.a.createElement(T.b,{className:"navItem",to:"/foodies"},"Find Foodies"),a.a.createElement(T.b,{className:"navItem",to:"/signup"},"Sign Up"),a.a.createElement(T.b,{className:"navItem",to:"/login"},"Login"))}}]),t}(r.Component),Y=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return a.a.createElement("footer",null,a.a.createElement("p",{className:"footerItem"},"Your Global Local Food Guide \xa9 2019"))}}]),t}(r.Component);var z=n(10),q=function(e){var t=e.history,n=Object(I.a)(e,["history"]),s=Object(r.useState)(""),c=Object(z.a)(s,2),o=c[0],u=c[1];return console.log(n),a.a.createElement("div",null,a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),o&&t.push("/city/".concat(o))},className:"search"},a.a.createElement("h2",{className:"title"},"YOUR GLOBAL LOCAL FOOD GUIDE"),a.a.createElement("input",{type:"text",placeholder:"Search a city",name:"city",onChange:function(e){return u(e.target.value)}}),a.a.createElement("button",{type:"submit"},"GO"),a.a.createElement("p",null,"Want to ",a.a.createElement("a",{href:"/signup"},"Signup?"))))},M=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={businesses:[],amount:50,user:null},n.service=new b,n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(u.a.mark((function e(){var t,n=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.service.isLoggedIn();case 3:t=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t=null;case 9:L(this.props.match.params.query,this.state.amount).then((function(e){n.setState({businesses:e.data.businesses,user:t})})).catch((function(e){console.error(e)}));case 10:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return console.log(this.props.user),a.a.createElement("div",null,a.a.createElement("h1",null,"Discover ",this.props.match.params.query),this.state.businesses.map((function(t,n){return a.a.createElement(k,Object.assign({key:n},t,{user:e.state.user}))})))}}]),t}(r.Component),J=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(m.a)(this,Object(h.a)(t).call(this))).getUserLocation=Object(i.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.geolocation.getCurrentPosition(function(){var e=Object(i.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={latitude:n.coords.latitude,longitude:n.coords.longitude},e.next=3,U.getRestaurants(t);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),e.getRestaurants=Object(i.a)(u.a.mark((function t(){var n,r,a,s,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.region,r=n.latitude,a=n.longitude,s={latitude:r,longitude:a},t.next=4,U.getRestaurants(s);case 4:c=t.sent,e.setState({restaurants:c});case 6:case"end":return t.stop()}}),t)}))),e.setUserState=function(t,n){var r=e.state.location?e.state.location:n;e.setState({user:t,setLocation:r,isLoadingUser:!1,err:null})},e.logout=Object(i.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.authService.logout();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0);case 8:return t.prev=8,e.setState({user:null}),t.finish(8);case 11:case"end":return t.stop()}}),t,null,[[0,5,8,11]])}))),e.state={user:null,isLoadingUser:!0,region:null,restaurants:[]},e.authService=new b,e}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.authService.isLoggedIn();case 3:t=e.sent,this.getUserLocation(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t=null;case 10:return e.prev=10,this.setUserState(t,void 0),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state;t.region,t.restaurants;return console.log("STATE",this.state.user),this.state.isLoadingUser?a.a.createElement(B,{className:"full-screen-loader"}):a.a.createElement("div",{className:"App"},a.a.createElement(W,{user:this.state.user,logout:this.logout}),a.a.createElement(g.d,null,a.a.createElement(g.b,{exact:!0,path:"/",component:q}),a.a.createElement(g.b,{exact:!0,path:"/city/:query",render:function(t){return a.a.createElement(M,Object.assign({},t,{user:e.state.user}))}}),a.a.createElement(g.b,{path:"/login",render:function(t){return a.a.createElement(R,Object.assign({},t,{setUserState:e.setUserState}))}}),a.a.createElement(g.b,{path:"/signup",render:function(t){return a.a.createElement(A,Object.assign({},t,{setUserState:e.setUserState}))}}),a.a.createElement(H,{path:"/profile",user:this.state.user,setUserState:this.setUserState,component:D})),a.a.createElement(Y,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(T.a,null,a.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[50,1,2]]]);
//# sourceMappingURL=main.2cf7440e.chunk.js.map